パッケージatmarkit;

import java.sql。*;

パブリッククラスMyDBAccess {

	プライベート文字列ドライバー。
	プライベート文字列のURL。
	プライベート文字列ユーザー。
	プライベート文字列パスワード。
	プライベート接続接続。
	プライベートステートメントステートメント;
	プライベートResultSet結果セット。

	/ **
	 *コンストラクタ
	 * @paramドライバードライバー
	 * @param url URL
	 * @param userユーザー名
	 * @param passwordパスワード
	 * /
	public MyDBAccess（String driver、String url、String user、String password）{
		this.driver = driver;
		this.url = url;
		this.user = user;
		this.password = password;
	}

	/ **
	 *引数なしのコンストラクタ
	 *規定値を使用する
	 * /
	public MyDBAccess（）{
		driver = "org.postgresql.Driver";
		url = "jdbc：postgresql：// localhost：5432 / jspdb";
		user = "postgres";
		パスワード= "";
	}

	/ **
	 *データベースへの接続を行う
	 * /
	public synchronized void open（）が例外をスローします{
		Class.forName（driver）;
		connection = DriverManager.getConnection（url、user、password）;
		ステートメント= connection.createStatement（）;
	}
	
	/ **
	 * SQL文を実行した結果のResultSetを返す
	 * @param sql SQL文
	 * /
	public ResultSet getResultSet（String sql）が例外をスローします{
		if（statement.execute（sql））{
			return statement.getResultSet（）;
		}
		nullを返します。
	}

	/ **
	 * SQL文の実行
	 * @param sql SQL文
	 * /
	public void execute（String sql）は例外{
		statement.execute（sql）;
	}

	/ **
	 *データベースへのコネクションのクローズ
	 * /
	public synchronized void close（）が例外をスローします{
		if（resultset！= null）resultset.close（）;
		if（statement！= null）statement.close（）;
		if（connection！= null）connection.close（）;
	}
}